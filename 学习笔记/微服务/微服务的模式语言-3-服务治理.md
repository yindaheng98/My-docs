# 微服务的模式语言-3-服务治理

## 服务发现

一个基于 RPI 的客户端如何在网络上发现服务实例的位置？

### 客户端服务发现（Client-side discovery）

客户端通过直接查询服务注册表获取服务实例的位置

### 服务器端服务发现（Server-side discovery）

路由模块通过查询服务注册表获取服务实例的位置

### 服务注册表（Service registry）

一个记录了服务实例位置的数据

### 自注册（Self registration）

服务实例自己完成向服务注册表的注册

### 第三方注册（3rd party registration）

通过第三方模块来进行服务实例信息到服务注册表的注册过程

## 测试（Testing）

如何更便捷的测试？

### 服务组件测试（Service Component Test）

a test suite that tests a service in isolation using test doubles for any services that it invokes

### 服务集成协议测试（Service Integration Contract Test）

a test suite for a service that is written by the developers of another service that consumes it

## 可观测性（Observability）

如何掌握一个运行中微服务应用的行为并进行有效的故障排错？

### 应用日志（Log aggregation）

聚合应用程序产生的日志文件

### 应用指标（Application metrics）

在代码中实现收集应用运营过程中各类指标的功能

### 审计日志（Audit logging）

把用户行为记录在数据库中供日后核查

### 分布式追踪（Distributed tracing）

在服务代码中针对每一个外部访问，都分配一个唯一的标识符，并在跨服务访问时传递这个标识符以供追踪分布式引发的问题。例如，当通过一个集中式服务处理外部请求时，记录请求本身的信息以及请求的开始和结束时间。

### 异常追踪（Exception tracking）

把所有服务程序代码触发的异常信息都汇聚到集中的异常追踪服务，并根据一定的逻辑对开发者或运维人员发出通知。

### 健康检查 API（Health check API）

一个监控服务可调用的 API，通常返回服务健康度信息，或对 ping 等心跳检查请求做出响应。

## 可靠性

如何避免由于服务故障或网络中断所引起的故障蔓延到其他服务？

### 断路器（Circuit Breaker）

当远端服务返回的故障率超过一定的阀值时，客户端代理（比如 API 网关）对远程服务的调用将立刻返回失败的信息
