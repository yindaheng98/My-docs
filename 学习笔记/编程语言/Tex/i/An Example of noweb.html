
<!-- saved from url=(0063)https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-2 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>An Example of noweb</title></head>
<body>

<h1>An Example of noweb</h1>
<address>Norman Ramsey<br>
Dept. of Computer Science, Princeton University<br>
Princeton, NJ 08544
</address>

<h2><a name="contents">Contents</a></h2>
<ul>
<li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#intro">Introduction</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#counting">Counting words</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#index">Index</a>
</li></ul>

<h2><a name="intro">Introduction</a></h2>

The following short program illustrates the use of <tt>noweb</tt>,
a low-tech tool for literate programming.
The purpose of the program is to provide a basis for 
comparing <tt>WEB</tt> and <tt>noweb</tt>, so I have used a program that has
been published before;
the text, code, and presentation are taken
from Chapter 12 of D. E. Knuth,
<cite>Literate Programming</cite>
(volume 27 of <cite>Center for the Study of
Language and Information Lecture Notes</cite>,
Stanford Univ., 1992).<p>

The notable differences are:
</p><ul>
<li>
When displaying source code,
<tt>noweb</tt> uses different typography.
In particular, <tt>WEB</tt> makes good use of multiple fonts
and the ablity to typeset mathematics, and it may use
 mathematical symbols in place of C symbols (e.g.
a logical ``and'' symbol for ``<code>&amp;&amp;</code>'').
<tt>noweb</tt> uses a single fixed-width font for code.
</li><li>
<tt>noweb</tt> can work with HTML, and I have used HTML in this example.
</li><li>
<tt>noweb</tt> has no numbered ``sections.''
When cross-referencing is needed, <tt>noweb</tt> uses hypertext links or page
numbers.
</li><li>
<tt>noweb</tt> has no special support for macros.
In the sample program, I have used
a ``Definitions'' chunk to hold
macro definitions.
</li><li>
<tt>noweb</tt>'s index of identifiers is less accurate than <tt>WEB</tt>'s,
because it uses a language-independent heuristic to find identifiers.
This heuristic may erroneously find ``uses'' of identifiers
in string literals or comments.
Although <tt>noweb</tt> does have a language-dependent algorithm for finding 
definitions of identifiers, that algorithm is less reliable than <tt>CWEB</tt>'s, 
because <tt>noweb</tt> does not really parse C code.
</li><li>
The <tt>CWEB</tt> version of this program has semicolons following most uses
of &lt;...&gt;.
<tt>WEB</tt> needs the semicolon or its equivalent to make 
its prettyprinting come out right.
Because it does not attempt prettyprinting, <tt>noweb</tt> needs no semicolons.
</li></ul>

<h2><a name="counting">Counting words</a></h2>

This example, based on a program by Klaus Guntermann and
Joachim Schrod (`<tt>WEB</tt> adapted to C.'
<cite>TUGboat</cite> <b>7</b>(3):134-7, Oct. 1986)
and a program by Silvio Levy and
D. E. Knuth (Ch. 12 of <cite>Literate Programming</cite>),
presents the ``word count''
program from Unix, rewritten in <tt>noweb</tt> to demonstrate
literate programming using <tt>noweb</tt>.
The level of detail in this document is intentionally high, for
didactic purposes; many of the things spelled out here don't need to
be explained in other programs.<p>

The purpose of <tt>wc</tt> is to count lines, words, and/or characters in
a list of files.
The number of lines in a file is the number of newline characters it
contains. 
The number of characters is the file length in bytes.
A ``word'' is a maximal sequence of consecutive characters other than
newline, space, or tab, containing at least one visible ASCII code.
<a name="NWD1Q08H5-1">(We assume that the standard ASCII code is in use.)</a></p><p>

Most literate C programs share a common structure.
It's probably a good idea to state the overall structure explicitly at
the outset, even though the various parts could all be introduced in
chunks named &lt;*&gt; if we wanted to add them piecemeal.</p><p>

Here, then, is an overview of the file <tt>wc.c</tt> that is defined by
the <tt>noweb</tt> program <tt>wc.nw</tt>:
</p><pre><a name="NW1Q08H5-1p0Y9w-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1"><dfn>&lt;*&gt;=</dfn></a>
<a name="NW1Q08H5-1p0Y9w-1-u1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-2"><i>&lt;Header files to include&gt;</i></a>
<a name="NW1Q08H5-1p0Y9w-1-u2" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3"><i>&lt;Definitions&gt;</i></a>
<a name="NW1Q08H5-1p0Y9w-1-u3" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1"><i>&lt;Global variables&gt;</i></a>
<a name="NW1Q08H5-1p0Y9w-1-u4" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1"><i>&lt;Functions&gt;</i></a>
<a name="NW1Q08H5-1p0Y9w-1-u5" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4"><i>&lt;The main program&gt;</i></a>
</pre><p>
<a name="NWD1Q08H5-2">We must include the standard I/O definitions, since we want to send</a>
formatted output to <code>stdout</code> and <code>stderr</code>.
</p><pre><a name="NW1Q08H5-4BXCU3-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-2"><dfn>&lt;Header files to include&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b>
#include &lt;stdio.h&gt;
</pre><p>

<a name="NWD1Q08H5-3">The </a><code><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a></code> variable will tell the operating system if the run was
successful or not, and <code><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">prog_name</a></code> is used in case there's an error
message to be printed.
</p><pre><a name="NW1Q08H5-4TccJC-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3"><dfn>&lt;Definitions&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b> <b>[D<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-4TccJC-2">-&gt;</a>]</b>
#define <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">OK</a>               0
  /* <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> code for successful run */
#define <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">usage_error</a>      1
  /* <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> code for improper syntax */
#define <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">cannot_open_file</a> 2
  /* <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> code for file access error */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-cannot_open_file"><code>cannot_open_file</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-OK"><code>OK</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-usage_error"><code>usage_error</code></a> (links are to index).<p>
</p></blockquote><pre><a name="NW1Q08H5-20zlE5-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1"><dfn>&lt;Global variables&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b> <b>[D<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">-&gt;</a>]</b>
int <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">OK</a>;
  /* exit <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> of command, initially <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">OK</a> */
char *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">prog_name</a>;
  /* who we are */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-prog_name"><code>prog_name</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-status"><code>status</code></a> (links are to index).<p>
</p></blockquote><p>
<a name="NWD1Q08H5-4">Now we come to the general layout of the </a><code><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">main</a></code>
function.
</p><pre><a name="NW1Q08H5-4O9khr-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4"><dfn>&lt;The main program&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b>
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">main</a>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>)
  int <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a>;
    /* number of arguments on UNIX command line */
  char **<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>;
    /* the arguments, an array of strings */
{
  <a name="NW1Q08H5-4O9khr-1-u1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5"><i>&lt;Variables local to <code>main</code>&gt;</i></a>
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">prog_name</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>[0];
  <a name="NW1Q08H5-4O9khr-1-u2" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1"><i>&lt;Set up option selection&gt;</i></a>
  <a name="NW1Q08H5-4O9khr-1-u3" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6"><i>&lt;Process all the files&gt;</i></a>
  <a name="NW1Q08H5-4O9khr-1-u4" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D"><i>&lt;Print the grand totals if there were multiple files&gt;</i></a>
  exit(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a>);
}
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-argc"><code>argc</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-argv"><code>argv</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-main"><code>main</code></a> (links are to index).<p>
</p></blockquote><p>
If the first argument begins with a `<code>-</code>', the
user is choosing the desired counts and specifying 
<a name="NWD1Q08H5-5">the order in which they should be displayed.  </a>
Each selection is given by the
initial character (lines, words, or characters).
For example, `<code>-cl</code>' would cause just the
number of characters and the number of lines to
be printed, in that order.</p><p>

We do not process this string now; we simply remember where it is.
It will be used to control the formatting at output time.
</p><pre><a name="NW1Q08H5-3A3V3n-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5"><dfn>&lt;Variables local to <code>main</code>&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">&lt;-U</a>)</b> <b>[D<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">-&gt;</a>]</b>
int <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a>;
  /* how many files there are */
char *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>;
  /* <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a> counts to print */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-file_count"><code>file_count</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-which"><code>which</code></a> (links are to index).<p>
</p></blockquote><pre><a name="NW1Q08H5-1QHDd2-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1"><dfn>&lt;Set up option selection&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">&lt;-U</a>)</b>
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a> = "lwc";
  /* if no option is given, print 3 values */
if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a> &gt; 1 &amp;&amp; *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>[1] == '-') {
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>[1] + 1;
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a>--;
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>++;
}
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a> - 1;
</pre><p>

<a name="NWD1Q08H5-6">Now we scan the remaining arguments and try to open a file, if possible.</a>
The file is processed and its statistics are given.
We use a <code>do ... while</code> loop because we should read from the standard
input if no file name is given.
</p><pre><a name="NW1Q08H5-WStOn-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6"><dfn>&lt;Process all the files&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">&lt;-U</a>)</b>
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a>--;
do {
  <a name="NW1Q08H5-WStOn-1-u1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1"><i>&lt;If a file is given, try to open <code>*(++argv)</code>; <code>continue</code> if unsuccessful&gt;</i></a>
  <a name="NW1Q08H5-WStOn-1-u2" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1"><i>&lt;Initialize pointers and counters&gt;</i></a>
  <a name="NW1Q08H5-WStOn-1-u3" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A"><i>&lt;Scan file&gt;</i></a>
  <a name="NW1Q08H5-WStOn-1-u4" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C"><i>&lt;Write statistics for file&gt;</i></a>
  <a name="NW1Q08H5-WStOn-1-u5" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-46WyEV-1"><i>&lt;Close file&gt;</i></a>
  <a name="NW1Q08H5-WStOn-1-u6" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1"><i>&lt;Update grand totals&gt;</i></a>
    /* even if there is only one file */
} while (--<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a> &gt; 0);
</pre><p>

<a name="NWD1Q08H5-7">Here's the code to open the file.  A special trick allows us to handle</a>
input from <code>stdin</code> when no name is given.
Recall that the file descriptor to <code>stdin</code> is 0; that's what we use
as the default initial value.
</p><pre><a name="NW1Q08H5-3A3V3n-2" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5"><dfn>&lt;Variables local to <code>main</code>&gt;+=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">&lt;-U</a>)</b> <b>[<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">&lt;-</a>D<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">-&gt;</a>]</b>
int <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">fd</a> = 0;
  /* file descriptor, initialized to stdin */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-fd"><code>fd</code></a> (links are to index).<p>
</p></blockquote><pre><a name="NW1Q08H5-4TccJC-2" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3"><dfn>&lt;Definitions&gt;+=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b> <b>[<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">&lt;-</a>D<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">-&gt;</a>]</b>
#define <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-4TccJC-2">READ_ONLY</a> 0
  /* read access code for system open */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-READ_ONLY"><code>READ_ONLY</code></a> (links are to index).<p>
</p></blockquote><pre><a name="NW1Q08H5-265ixA-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1"><dfn>&lt;If a file is given, try to open <code>*(++argv)</code>; <code>continue</code> if unsuccessful&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">&lt;-U</a>)</b>
if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a> &gt; 0
&amp;&amp; (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">fd</a> = open(*(++<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>), <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-4TccJC-2">READ_ONLY</a>)) &lt; 0) {
  fprintf(stderr, 
    "%s: cannot open file %s\n",
    <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">prog_name</a>, *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>);
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> |= <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">cannot_open_file</a>;
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a>--;
  continue;
}
</pre><pre><a name="NW1Q08H5-46WyEV-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-46WyEV-1"><dfn>&lt;Close file&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">&lt;-U</a>)</b>
close(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">fd</a>);
</pre><p>
<a name="NWD1Q08H5-8">We will do some homemade buffering in order to speed things up:</a>
Characters will be read into the <code><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a></code> array before we process
them.
To do this we set up appropriate pointers and counters.
</p><pre><a name="NW1Q08H5-4TccJC-3" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3"><dfn>&lt;Definitions&gt;+=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b> <b>[<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-4TccJC-2">&lt;-</a>D<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">-&gt;</a>]</b>
#define <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">buf_size</a> BUFSIZ
  /* stdio.h BUFSIZ chosen for efficiency */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-buf_size"><code>buf_size</code></a> (links are to index).<p>
</p></blockquote><pre><a name="NW1Q08H5-3A3V3n-3" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5"><dfn>&lt;Variables local to <code>main</code>&gt;+=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">&lt;-U</a>)</b> <b>[<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">&lt;-</a>D]</b>
char <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a>[<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">buf_size</a>];
  /* we read the input into this array */
register char *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">ptr</a>;
  /* first unprocessed character in <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a> */
register char *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buf_end</a>;
  /* the first unused position in <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a> */
register int <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a>;
  /* current char, or # of chars just read */
int <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">in_word</a>;
  /* are we within a word? */
long <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a>;
  /* # of words, lines, and chars so far */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-buf_end"><code>buf_end</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-buffer"><code>buffer</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-c"><code>c</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-char_count"><code>char_count</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-in_word"><code>in_word</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-line_count"><code>line_count</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-ptr"><code>ptr</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-word_count"><code>word_count</code></a> (links are to index).<p>
</p></blockquote><pre><a name="NW1Q08H5-1N2DLp-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1"><dfn>&lt;Initialize pointers and counters&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">&lt;-U</a>)</b>
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">ptr</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buf_end</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a>;
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a> = 0;
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">in_word</a> = 0;
</pre><p>

<a name="NWD1Q08H5-9">The grand totals must be initialized to zero at the beginning of the</a>
program.
If we made these variables local to <code><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">main</a></code>, we would have to do this
initialization explicitly; however, C's globals are automatically
zeroed. (Or rather, ``statically zeroed.'')  (Get it?)
</p><pre><a name="NW1Q08H5-20zlE5-2" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1"><dfn>&lt;Global variables&gt;+=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b> <b>[<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">&lt;-</a>D]</b>
long <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_word_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_line_count</a>, 
     tot_char_count;
  /* total number of words, lines, chars */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-tot_line_count"><code>tot_line_count</code></a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-tot_word_count"><code>tot_word_count</code></a> (links are to index).<p>
</p></blockquote><p>

<a name="NWD1Q08H5-A">The present chunk, which does the counting that is </a><tt>wc</tt>'s
<i>raison d'etre</i>, was actually one of the simplest to write.
We look at each character and change state if it begins or ends a word.
</p><pre><a name="NW1Q08H5-33zymD-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A"><dfn>&lt;Scan file&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">&lt;-U</a>)</b>
while (1) {
  <a name="NW1Q08H5-33zymD-1-u1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B"><i>&lt;Fill <code>buffer</code> if it is empty; <code>break</code> at end of file&gt;</i></a>
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> = *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">ptr</a>++;
  if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> &gt; ' ' &amp;&amp; <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> &lt; 0177) {
    /* visible ASCII codes */
    if (!<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">in_word</a>) {
      <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>++;
      <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">in_word</a> = 1;
    }
    continue;
  }
  if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> == '\n') <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>++;
  else if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> != ' ' &amp;&amp; <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> != '\t') continue;
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">in_word</a> = 0;
    /* <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> is newline, space, or tab */
}
</pre><p>

<a name="NWD1Q08H5-B">Buffered I/O allows us to count the number of characters almost for</a>
free.
</p><pre><a name="NW1Q08H5-2hMY49-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B"><dfn>&lt;Fill <code>buffer</code> if it is empty; <code>break</code> at end of file&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">&lt;-U</a>)</b>
if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">ptr</a> &gt;= <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buf_end</a>) {
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">ptr</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a>;
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> = read(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">fd</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">ptr</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">buf_size</a>);
  if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a> &lt;= 0) break;
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a> += <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a>;
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buf_end</a> = <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a> + <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a>;
}
</pre><p>

<a name="NWD1Q08H5-C">It's convenient to output the statistics by defining a new function</a>
<code><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">wc_print</a></code>; then the same function can be used for the totals.
Additionally we must decide here if we know the name of the file we have
processed or if it was just <code>stdin</code>.
</p><pre><a name="NW1Q08H5-4MDQgI-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C"><dfn>&lt;Write statistics for file&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">&lt;-U</a>)</b>
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">wc_print</a>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>, 
         <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>);
if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a>)
  printf(" %s\n", *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>); /* not stdin */
else 
  printf("\n");           /* stdin */
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-wc_print"><code>wc_print</code></a> (links are to index).<p>
</p></blockquote><p>
</p><pre><a name="NW1Q08H5-38ct1-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1"><dfn>&lt;Update grand totals&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">&lt;-U</a>)</b>
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_line_count</a> += <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>;
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_word_count</a> += <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>;
tot_char_count += <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a>;
</pre><p>

<a name="NWD1Q08H5-D">We might as well improve a bit on Unix's </a><tt>wc</tt> by displaying
the number of files too.
</p><pre><a name="NW1Q08H5-2DyJzR-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D"><dfn>&lt;Print the grand totals if there were multiple files&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">&lt;-U</a>)</b>
if (<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a> &gt; 1) {
  <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">wc_print</a>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>, tot_char_count, 
           <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_word_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_line_count</a>);
  printf(" total in %d files\n", <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a>);
}
</pre><p>

<a name="NWD1Q08H5-E">Here now is the function that prints the values according to the</a>
specified options.
The calling routine is supposed to supply a newline.
If an invalid option character is found we inform the user about proper
usage of the command.
Counts are printed in 8-digit fields so that they will line up in
columns.
</p><pre><a name="NW1Q08H5-4TccJC-4" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3"><dfn>&lt;Definitions&gt;+=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b> <b>[<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">&lt;-</a>D]</b>
#define <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">print_count</a>(n) printf("%8ld", n)
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-print_count"><code>print_count</code></a> (links are to index).<p>
</p></blockquote><pre><a name="NW1Q08H5-1byJZg-1" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1"><dfn>&lt;Functions&gt;=</dfn></a> <b>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">&lt;-U</a>)</b>
<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">wc_print</a>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>)
  char *<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>;  /* <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a> counts to print */
  long <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>;
    /* given totals */
{
  while (*<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>)
    switch (*<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>++) {
      case 'l': <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">print_count</a>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>);
        break;
      case 'w': <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">print_count</a>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>);
        break;
      case 'c': <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">print_count</a>(<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a>);
        break;
      default:
        if ((<a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> &amp; <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">usage_error</a>) == 0) {
          fprintf(stderr,
            "\nUsage: %s [-lwc] [filename ...]\n",
            <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">prog_name</a>);
          <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a> |= <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">usage_error</a>;
        }
    }
}
</pre><blockquote>Defines <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWI-wc_print"><code>wc_print</code></a> (links are to index).<p>
</p></blockquote><p>
Incidentally, a test of this program against the system <tt>wc</tt>
command on a SPARCstation showed that the ``official'' <tt>wc</tt> was
slightly slower.
Furthermore, although that <tt>wc</tt> gave an appropriate error message
for the options `<code>-abc</code>', it made no complaints about the options
`<code>-labc</code>'!
Dare we suggest that the system routine might have been better if its
<a name="NWD1Q08H5-F">programmer had used a more literate approach?</a>

</p><h2><a name="index">Index</a></h2>
<h3>Chunks
<ul>
<li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1"><i>&lt;*&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">D1</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-46WyEV-1"><i>&lt;Close file&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-46WyEV-1">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3"><i>&lt;Definitions&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">D2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-4TccJC-2">D3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">D4</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">D5</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B"><i>&lt;Fill <code>buffer</code> if it is empty; <code>break</code> at end of file&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1"><i>&lt;Functions&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1"><i>&lt;Global variables&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">D2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">D3</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-2"><i>&lt;Header files to include&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-2">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1"><i>&lt;If a file is given, try to open <code>*(++argv)</code>; <code>continue</code> if unsuccessful&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1"><i>&lt;Initialize pointers and counters&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D"><i>&lt;Print the grand totals if there were multiple files&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6"><i>&lt;Process all the files&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A"><i>&lt;Scan file&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1"><i>&lt;Set up option selection&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4"><i>&lt;The main program&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-1">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1"><i>&lt;Update grand totals&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1">D2</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5"><i>&lt;Variables local to <code>main</code>&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">D2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">D3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D4</a>
</li><li><a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C"><i>&lt;Write statistics for file&gt;</i></a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">D2</a>
</li></ul>

</h3><h3>Indentifiers
<ul>
<li><a name="NWI-argc" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argc</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-6">U3</a>
</li><li><a name="NWI-argv" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">argv</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">U4</a>
</li><li><a name="NWI-buf_end" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buf_end</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">U3</a>
</li><li><a name="NWI-buf_size" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">buf_size</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-8">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">U3</a>
</li><li><a name="NWI-buffer" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">buffer</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">U3</a>
</li><li><a name="NWI-c" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">c</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">U3</a>
</li><li><a name="NWI-cannot_open_file" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">cannot_open_file</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">U2</a>
</li><li><a name="NWI-char_count" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">char_count</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">U4</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1">U5</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U6</a>
</li><li><a name="NWI-fd" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">fd</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-7">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-46WyEV-1">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">U4</a>
</li><li><a name="NWI-file_count" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">file_count</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">U4</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D">U5</a>
</li><li><a name="NWI-in_word" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">in_word</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">U3</a>
</li><li><a name="NWI-line_count" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">line_count</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">U4</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1">U5</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U6</a>
</li><li><a name="NWI-main" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">main</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">D1</a>
</li><li><a name="NWI-OK" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">OK</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">U2</a>
</li><li><a name="NWI-print_count" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">print_count</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-E">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U2</a>
</li><li><a name="NWI-prog_name" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">prog_name</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U4</a>
</li><li><a name="NWI-ptr" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">ptr</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-B">U4</a>
</li><li><a name="NWI-READ_ONLY" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-4TccJC-2">READ_ONLY</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-4TccJC-2">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">U2</a>
</li><li><a name="NWI-status" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">status</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">U1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-20zlE5-1">D2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-4">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-265ixA-1">U4</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U5</a>
</li><li><a name="NWI-tot_line_count" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_line_count</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D">U3</a>
</li><li><a name="NWI-tot_word_count" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">tot_word_count</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-9">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D">U3</a>
</li><li><a name="NWI-usage_error" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">usage_error</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U2</a>
</li><li><a name="NWI-wc_print" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">wc_print</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">D3</a>
</li><li><a name="NWI-which" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">which</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-5">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1QHDd2-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-D">U4</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U5</a>
</li><li><a name="NWI-word_count" href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">word_count</a>: <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-3A3V3n-3">D1</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1N2DLp-1">U2</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-A">U3</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NWD1Q08H5-C">U4</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-38ct1-1">U5</a>, <a href="https://www.cs.tufts.edu/~nr/noweb/examples/wc.html#NW1Q08H5-1byJZg-1">U6</a>
</li></ul>






</h3></body></html>